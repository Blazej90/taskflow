<header class="header">
  <h1>Tasks</h1>
  <a
    class="btn"
    routerLink="/tasks/new"
    [class.disabled]="loading()"
    [attr.aria-disabled]="loading()"
  >
    + New task
  </a>
</header>

<div class="filters">
  <button
    type="button"
    class="chip"
    [class.active]="statusFilter() === 'all'"
    [disabled]="loading()"
    (click)="setFilter('all')"
  >
    All ({{ totalCount() }})
  </button>
  <button
    type="button"
    class="chip"
    [class.active]="statusFilter() === 'todo'"
    [disabled]="loading()"
    (click)="setFilter('todo')"
  >
    Todo ({{ todoCount() }})
  </button>
  <button
    type="button"
    class="chip"
    [class.active]="statusFilter() === 'doing'"
    [disabled]="loading()"
    (click)="setFilter('doing')"
  >
    Doing ({{ doingCount() }})
  </button>
  <button
    type="button"
    class="chip"
    [class.active]="statusFilter() === 'done'"
    [disabled]="loading()"
    (click)="setFilter('done')"
  >
    Done ({{ doneCount() }})
  </button>
</div>

<div class="search-row">
  <mat-form-field appearance="outline" class="search-field">
    <mat-label>Search</mat-label>
    <input
      matInput
      type="text"
      placeholder="Search tasks by title..."
      [disabled]="loading()"
      [ngModel]="searchTerm()"
      (ngModelChange)="searchTerm.set($event)"
    />
  </mat-form-field>

  <mat-form-field appearance="outline" class="sort-field">
    <mat-label>Sort</mat-label>
    <mat-select [ngModel]="sortBy()" (ngModelChange)="sortBy.set($event)">
      <mat-option value="newest">Newest first</mat-option>
      <mat-option value="oldest">Oldest first</mat-option>
      <mat-option value="status">Status</mat-option>
    </mat-select>
  </mat-form-field>
</div>

<section class="list">
  <app-task-card
    *ngFor="let t of filteredTasks()"
    [task]="t"
    (remove)="removeTask($event)"
    (toggle)="toggleTaskStatus($event)"
  ></app-task-card>
</section>

<div *ngIf="isEmpty()" class="empty">
  <h3>No tasks here ðŸ‘€</h3>
  <p>Create a new task or change the filter.</p>
  <a class="btn" routerLink="/tasks/new">+ New task</a>
</div>
